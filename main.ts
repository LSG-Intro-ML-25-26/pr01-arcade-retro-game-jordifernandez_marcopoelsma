function isPlayerInGhostRoom () {
    for (let index = 0; index <= ghostSpawnRoomTiles.length - 1; index++) {
        if (tiles.tileIs(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), ghostSpawnRoomTiles[index])) {
            win = true
            break;
        } else {
            win = false
        }
    }
}
function ghostAbilitiesList () {
    if (currentGhostAbility == "Oni") {
        flashingGhost = flashingGhost * 0.2
        setGhostAnimation()
    } else if (currentGhostAbility == "Demon") {
        maxAtkCooldown = minAtkCooldown
        minAtkCooldown = minAtkCooldown * 0
    } else if (currentGhostAbility == "Revenant") {
        ghostSpeed = ghostSpeed * 0.5
        ghostSightSpeed = ghostSightSpeed * 1.5
    } else if (currentGhostAbility == "Deogen") {
        looseTrailTime = maxHuntTime
        wallHacks = true
        ghostSightSpeed = ghostSightSpeed * 1.3
        ghostCloseSpeed = ghostCloseSpeed * 0.5
        sightRange = 999999999999
        ghostSight = true
    } else if (currentGhostAbility == "Yokai") {
        sightRange = sightRange * 0.2
        looseTrailTime = looseTrailTime * 0.4
    } else if (currentGhostAbility == "Mimic") {
        minMimicCooldown = 4000
        maxMimicCooldown = 6000
    }
}
function setMap () {
    tiles.setCurrentTilemap(tilemap`TangleWood`)
    scene.setBackgroundImage(img`
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
        `)
    setUtilTiles()
}
function changToHuntPalette () {
    color.startFadeFromCurrent(color.Adventure, 500)
    for (let index = 0; index < 500; index++) {
        color.setColor(1, color.rgb(255, 255, 255))
        color.setColor(2, color.rgb(255, 0, 0))
        color.setColor(15, color.rgb(0, 0, 0))
        pause(1)
    }
}
function setUtilTiles () {
    setRooms()
    houseDefualtTiles = [
    assets.tile`miMosaico2`,
    assets.tile`moqueta`,
    assets.tile`moqueta2`,
    assets.tile`bathroom`,
    assets.tile`floor1`,
    assets.tile`moqueta1`,
    assets.tile`suelo3`,
    assets.tile`floor2`,
    assets.tile`floor4`,
    assets.tile`myTile4`
    ]
    selectDiffTile = assets.tile`setDiffTile`
    otherHouseTilescantSpawn = [
    assets.tile`mesa L`,
    assets.tile`mesaR`,
    assets.tile`floorWithDoor1`,
    assets.tile`moquetaDoorR`,
    assets.tile`moquetaDoorL`,
    assets.tile`bathrooDoor`,
    assets.tile`romboRoomDoorL0`,
    assets.tile`romboRoomDoorR`,
    assets.tile`suelArmarioD`,
    assets.tile`TablemoquetaL0`,
    assets.tile`TablemoquetaR`,
    assets.tile`moquetaTableLR0`,
    assets.tile`moquetaTableL0`,
    assets.tile`moquetaTableR`
    ]
    hideTiles = [assets.tile`hideLeft`, assets.tile`hideDown`, assets.tile`hideUp`]
    openDoor = assets.tile`myTile7`
    closedDoor = assets.tile`doorClose`
    wallList = [
    assets.tile`myTile2`,
    assets.tile`outsideWall`,
    assets.tile`mesa`,
    assets.tile`miMosaico7`,
    assets.tile`isla de cocina`,
    assets.tile`miMosaico`,
    assets.tile`transparency16`,
    assets.tile`miMosaico7`,
    assets.tile`noTextureFurniture`,
    assets.tile`noTextureWall`,
    assets.tile`fenceL`,
    assets.tile`fenceR`,
    assets.tile`fenceLCorner`,
    assets.tile`fenceRCorner`,
    assets.tile`fenceDown`,
    assets.tile`fenceDownR`,
    assets.tile`fenceCornerIn`,
    assets.tile`fenceUp`,
    assets.tile`fenceCornerLup`,
    assets.tile`fecneCornerRdown`,
    assets.tile`doorPermenantlyClosed`,
    assets.tile`vanInteriorWall`,
    assets.tile`miMosaico4`,
    assets.tile`vanWheel`,
    assets.tile`van light`,
    assets.tile`vanCornerR0`,
    assets.tile`vanCornerL`,
    assets.tile`vanGlass`,
    assets.tile`vanGlessCorner`,
    assets.tile`grassOutOfBounds`,
    assets.tile`kitchen sink`,
    assets.tile`kitchenFogones`,
    assets.tile`kitchenTable`,
    assets.tile`kitchenKnive`,
    assets.tile`kitchenPaSecar`,
    assets.tile`kitchenFreezer`,
    assets.tile`white`,
    assets.tile`vanQlo`,
    assets.tile`closedUL0`,
    assets.tile`closedUR`,
    assets.tile`closetDR`,
    assets.tile`closetDL0`,
    assets.tile`brokenFloorLU1`,
    assets.tile`brokenFloorRU1`,
    assets.tile`brokenFloorLD1`,
    assets.tile`brokenFloorLU0`,
    assets.tile`brokenFloorRU0`,
    assets.tile`brokenFloorLD0`,
    assets.tile`bujeroRU`,
    assets.tile`bujeroLD`,
    assets.tile`tableTop`,
    assets.tile`miMosaico10`,
    assets.tile`miMosaico5`,
    assets.tile`miMosaico12`,
    assets.tile`tableLtv`,
    assets.tile`tableRtv`,
    assets.tile`MapTR`,
    assets.tile`mapLR`,
    assets.tile`mapLL`,
    assets.tile`MapTR`,
    assets.tile`ma単eraC`,
    assets.tile`armarioD`,
    assets.tile`armarioU`,
    assets.tile`tv0`,
    assets.tile`tvR`,
    assets.tile`tvD`,
    assets.tile`TVU`,
    assets.tile`ba単eraU`,
    assets.tile`vaterU`,
    assets.tile`espejoBa単o`,
    assets.tile`ba単eraD`,
    assets.tile`sofaU`,
    assets.tile`sofaM`,
    assets.tile`sofaD`,
    assets.tile`mesitaTV`,
    assets.tile`vaterD`,
    assets.tile`grifoBath`,
    assets.tile`sofaL`,
    assets.tile`sofaR`,
    assets.tile`bedUL`,
    assets.tile`bedDR`,
    assets.tile`bedML`,
    assets.tile`bedCR`,
    assets.tile`bedUR`,
    assets.tile`bedDL`,
    assets.tile`maceta`,
    assets.tile`girasol`,
    assets.tile`tulihuevo`,
    assets.tile`cactus`,
    assets.tile`portatil`,
    assets.tile`fruta`,
    assets.tile`marron`
    ]
    for (let wall of wallList) {
        tileUtil.setWalls(wall, true)
    }
}
function setPlayerSpawnAndCam () {
    mainCharacter = sprites.create(assets.image`mainPlayerR`, SpriteKind.Player)
    tiles.placeOnRandomTile(mainCharacter, assets.tile`playerSpawn`)
}
function noSelectMenu () {
    ghostReveal.setFrame(img`
        ..bbabbaabbaabbaabbbbb..
        .bddbaddbaddbaddbabbddb.
        addddbaddbaddbaddbadddda
        addddbbaabbaabbaabbdddda
        abddbccccccccccccccbddba
        bbabccccccccccccccccbbab
        babbccccccccccccccccbadb
        abdaccccccccccccccccadda
        addaccccccccccccccccadba
        bdabccccccccccccccccbbab
        babbccccccccccccccccbadb
        abdaccccccccccccccccadda
        addaccccccccccccccccadba
        bdabccccccccccccccccbbab
        babbccccccccccccccccbadb
        abdaccccccccccccccccadda
        addaccccccccccccccccadba
        bdabccccccccccccccccbbab
        babbccccccccccccccccbabb
        abddbccccccccccccccbddba
        addddbbaabbaabbaabbdddda
        addddabddabddabddabdddda
        .addbbabddabddabddabdda.
        ..aaabbaabbaabbaabbaaa..
        `)
    ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Width, 160)
    ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Height, 60)
    ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Rows, 2)
    ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Columns, 1)
    ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.BackgroundColor, 11)
    ghostReveal.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.Alignment, 1)
    ghostReveal.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.BorderColor, 13)
    ghostReveal.setStyleProperty(miniMenu.StyleKind.DefaultAndSelected, miniMenu.StyleProperty.Foreground, 16)
    ghostReveal.setStyleProperty(miniMenu.StyleKind.DefaultAndSelected, miniMenu.StyleProperty.Alignment, 1)
    ghostReveal.setStyleProperty(miniMenu.StyleKind.DefaultAndSelected, miniMenu.StyleProperty.Background, 11)
    ghostReveal.setPosition(scene.cameraProperty(CameraProperty.X), scene.cameraProperty(CameraProperty.Y))
}
function setGhostStats () {
    maxAtkCooldown = 5000 / difficulty
    minAtkCooldown = 10000 / difficulty
    maxHuntTime = 15000 * difficulty
    minHuntTime = 20000 * difficulty
    looseTrailTime = 5000 * difficulty
    ghostSpeed = 100 * difficulty
    ghostSightSpeed = ghostSpeed
    ghostCloseSpeed = ghostSpeed
    wallHacks = false
    sightRange = 160 * difficulty
    flashingGhost = 300
    setGhostAnimation()
}
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    if (!(ghostReadyToHunt) && !(openedMenu) && !(openOtherMenu) && !(infoDisplayed)) {
        openedMenu = true
        controller.moveSprite(mainCharacter, 0, 0)
        inputGhostType = miniMenu.createMenuFromArray([
        miniMenu.createMenuItem(ghostList[0], skullList[0]),
        miniMenu.createMenuItem(ghostList[1], skullList[1]),
        miniMenu.createMenuItem(ghostList[2], skullList[2]),
        miniMenu.createMenuItem(ghostList[3], skullList[3]),
        miniMenu.createMenuItem(ghostList[4], skullList[4]),
        miniMenu.createMenuItem(ghostList[5], skullList[5])
        ])
        inputGhostType.setFrame(img`
            ..................................................................
            ............fff........fff.............fff..............ffff......
            ...........fddbf......fbdbf...........fbdbf............fbddf......
            ...........fddbbf.....fdddffff........fdddffff...fff..ffddbff.....
            ...........fddddffffffbdddbddbffffffffbdddbddbffffddffddddddf.....
            ...fff....fdddddfddddddddbbddddddddddddddbbddddddfdddddbccddf.....
            .fffddf..fddffffddddddddddbbddddddddddddddbbdddddffbddbbddff......
            .fdbddfffddfffdddfffffbdddbddbffffffffbdddbddbfffefddccbddf.......
            .fdddcddddffeffffeeeeefbdbfddfeeeeeeeefbdbfddfeeeefffcddddf.......
            .fbddcddddfeeeeeeeeeeeefffffffeeeeeeeeefffffffeeeeeeefdddddf......
            ..ffdbbbddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefffffddf.....
            ...fddbcddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffddfff..
            ....fddccffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffddddf.
            ....fdddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefffddddf.
            ...fddbdfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefdfddbbf.
            ...fddfffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefdfddbf..
            ...ffffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddfff...
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ...fbddbffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ...fdddddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ...fddbddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefbddbff..
            ..ffbbbbffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefbdddddbf.
            .fbddbddbfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefdddddddf.
            .fdddddddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefbddbddbf.
            .fbdddddbfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffbbbbff..
            ..ffbddbfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddbddf...
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefdddddf...
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffbddbf...
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ...fbddbffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ...fdddddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ...fddbddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefbddbff..
            ..ffbbbbffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefbdddddbf.
            .fbddbddbfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefdddddddf.
            .fdddddddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefbddbddbf.
            .fbdddddbfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffbbbbff..
            ..ffbddbfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddbddf...
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefdddddf...
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffbddbf...
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ....fddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddf....
            ...fffddfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffff...
            ..fbddfdfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefffddf...
            .fbbddfdfeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefdbddf...
            .fddddfffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefdddf....
            .fddddffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeffccddf....
            ..fffddffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddcbddf...
            .....fddfffffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeefddbbbdff..
            ......fdddddfeeeeeeefffffffeeeeeeeeefffffffeeeeeeeeeeeefddddcddbf.
            .......fddddcfffeeeefddfbdbfeeeeeeeefddfbdbfeeeeeffffeffddddcdddf.
            .......fddbccddfefffbddbdddbffffffffbddbdddbfffffdddfffddfffddbdf.
            ......ffddbbddbffdddddbbddddddddddddddbbddddddddddffffddf..fddfff.
            .....fddccbdddddfddddddbbddddddddddddddbbddddddddfdddddf....fff...
            .....fddddddffddffffbddbdddbffffffffbddbdddbffffffddddf...........
            .....ffbddff..fff...ffffdddf........ffffdddf.....fbbddf...........
            ......fddbf............fbdbf...........fbdbf......fbddf...........
            ......ffff..............fff.............fff........fff............
            ..................................................................
            `)
        inputGhostType.setTitle("INPUT GHOST TYPE")
        inputGhostType.setMenuStyleProperty(miniMenu.MenuStyleProperty.Width, 180)
        inputGhostType.setMenuStyleProperty(miniMenu.MenuStyleProperty.Height, 110)
        inputGhostType.setMenuStyleProperty(miniMenu.MenuStyleProperty.Rows, 3)
        inputGhostType.setMenuStyleProperty(miniMenu.MenuStyleProperty.Columns, 2)
        inputGhostType.setStyleProperty(miniMenu.StyleKind.Default, miniMenu.StyleProperty.Alignment, 0)
        inputGhostType.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.Alignment, 1)
        inputGhostType.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.Alignment, 1)
        inputGhostType.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.BorderColor, 11)
        inputGhostType.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.Background, 11)
        inputGhostType.setStyleProperty(miniMenu.StyleKind.Default, miniMenu.StyleProperty.Background, 13)
        inputGhostType.setPosition(scene.cameraProperty(CameraProperty.X), scene.cameraProperty(CameraProperty.Y))
        inputGhostType.onButtonPressed(controller.A, function (selection, selectedIndex) {
            if (canHunt) {
                if (selectedIndex == ghostList.indexOf(currentGhostType)) {
                    win = true
                    isPlayerInGhostRoom()
                }
                gameOver2()
            }
        })
        inputGhostType.onButtonPressed(controller.B, function (selection, selectedIndex) {
            controller.moveSprite(mainCharacter, playerVelocity, playerVelocity)
            inputGhostType.close()
            pause(1000)
            openedMenu = false
        })
    }
})
function setDifficulty () {
    if (!(isDifficultySetted)) {
        incenseState = true
        openOtherMenu = true
        controller.moveSprite(mainCharacter, 0, 0)
        setDifficultyMenu = miniMenu.createMenuFromArray([miniMenu.createMenuItem("Hard", assets.image`hard`), miniMenu.createMenuItem("Normal", assets.image`baseKull`), miniMenu.createMenuItem("Easy", assets.image`easy`)])
        setDifficultyMenu.setTitle("SET DIFFICULTY")
        setDifficultyMenu.setFrame(img`
            .....cccccccccccccc.....
            ...cbd111111111111dbc...
            ..cd1111111111111111dc..
            .cd111111111111111111dc.
            .b11111111111111111111b.
            cd11111111111111111111dc
            c1111111111111111111111c
            c1111111111111111111111c
            c1111111111111111111111c
            c1111111111111111111111c
            c1111111111111111111111c
            c1111111111111111111111c
            c1111111111111111111111c
            c1111111111111111111111c
            c1111111111111111111111c
            c1111111111111111111111c
            cd11111111111111111111dc
            cb11111111111111111111bc
            ccd111111111111111111dc.
            .ccd1111111111111111dcc.
            ..ccbd111111111111dbcc..
            ...cccccccccccccccccc...
            ...cccccccccccccccc.....
            ........................
            `)
        setDifficultyMenu.setMenuStyleProperty(miniMenu.MenuStyleProperty.Width, 105)
        setDifficultyMenu.setMenuStyleProperty(miniMenu.MenuStyleProperty.Height, 96)
        setDifficultyMenu.setMenuStyleProperty(miniMenu.MenuStyleProperty.BackgroundColor, 1)
        setDifficultyMenu.setStyleProperty(miniMenu.StyleKind.Default, miniMenu.StyleProperty.Alignment, 0)
        setDifficultyMenu.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.Alignment, 1)
        setDifficultyMenu.setStyleProperty(miniMenu.StyleKind.Title, miniMenu.StyleProperty.Alignment, 1)
        setDifficultyMenu.setStyleProperty(miniMenu.StyleKind.Selected, miniMenu.StyleProperty.Background, 6)
        setDifficultyMenu.setStyleProperty(miniMenu.StyleKind.Default, miniMenu.StyleProperty.Background, 13)
        setDifficultyMenu.setPosition(scene.cameraProperty(CameraProperty.X), scene.cameraProperty(CameraProperty.Y))
        setDifficultyMenu.onButtonPressed(controller.A, function (selection, selectedIndex) {
            if (selection == "Hard") {
                difficulty = 1.1
                setPlayerStats()
                incenseCount = 0
                selectedDiff = sprites.create(assets.image`hard`, SpriteKind.Food)
                for (let wall2 of hideTiles) {
                    tileUtil.setWalls(wall2, true)
                    tileUtil.coverAllTiles(wall2, assets.tile`outsideWall`)
                }
            } else if (selection == "Normal") {
                difficulty = 1
                setPlayerStats()
                incenseCount = 1
                selectedDiff = sprites.create(assets.image`baseKull`, SpriteKind.Food)
            } else if (selection == "Easy") {
                difficulty = 0.9
                setPlayerStats()
                incenseCount = 2
                selectedDiff = sprites.create(assets.image`easy`, SpriteKind.Food)
            }
            info.setLife(incenseCount)
            tiles.placeOnRandomTile(selectedDiff, selectDiffTile)
            setGhostStats()
            setGhostType()
            isDifficultySetted = true
            openOtherMenu = false
            controller.moveSprite(mainCharacter, playerVelocity, playerVelocity)
            setDifficultyMenu.close()
        })
        setDifficultyMenu.onButtonPressed(controller.B, function (selection, selectedIndex) {
            openOtherMenu = false
            controller.moveSprite(mainCharacter, playerVelocity, playerVelocity)
            setDifficultyMenu.close()
        })
        while (openOtherMenu) {
            pause(1000)
        }
        pause(1500)
        incenseState = false
    }
}
function setRooms () {
    rooms = [
    roomKitchen,
    roomHallway,
    roomTVRoom,
    roomDinningRoom,
    roomBedRoom,
    roomBathRoom,
    roomLockerRoom,
    roomEntranceRoom,
    roomStorageRoom,
    roomRuinsRoom
    ]
    roomKitchen = [assets.tile`miMosaico2`]
    roomHallway = [
    assets.tile`moqueta`,
    assets.tile`moquetaTableLR0`,
    assets.tile`moquetaTableL0`,
    assets.tile`moquetaTableR`
    ]
    roomTVRoom = [assets.tile`moqueta2`]
    roomDinningRoom = [
    assets.tile`floor1`,
    assets.tile`mesa L`,
    assets.tile`mesaR`,
    assets.tile`floorWithDoor1`
    ]
    roomBedRoom = [
    assets.tile`moqueta1`,
    assets.tile`TablemoquetaR`,
    assets.tile`moqueta1`,
    assets.tile`moquetaDoorL`,
    assets.tile`moquetaDoorR`
    ]
    roomBathRoom = [assets.tile`bathroom`, assets.tile`bathrooDoor`]
    roomLockerRoom = [assets.tile`suelo3`, assets.tile`suelArmarioD`]
    roomEntranceRoom = [assets.tile`floor2`]
    roomStorageRoom = [assets.tile`floor4`]
    roomRuinsRoom = [assets.tile`myTile4`]
}
function setGhost () {
    ghost = sprites.create(img`
        ........................
        ........................
        ........................
        ........................
        ..........ffff..........
        ........ff1111ff........
        .......fb111111bf.......
        .......f11111111f.......
        ......fd11111111df......
        ......fd11111111df......
        ......fddd1111dddf......
        ......fbdbfddfbdbf......
        ......fcdcf11fcdcf......
        .......fb111111bf.......
        ......fffcdb1bdffff.....
        ....fc111cbfbfc111cf....
        ....f1b1b1ffff1b1b1f....
        ....fbfbffffffbfbfbf....
        .........ffffff.........
        ...........fff..........
        ........................
        ........................
        ........................
        ........................
        `, SpriteKind.Enemy)
    ghost.setScale(0, ScaleAnchor.Middle)
    ghostSpawnRoomIndex = randint(0, rooms.length - 1)
    ghostSpawnRoom = houseDefualtTiles[ghostSpawnRoomIndex]
    ghostSpawnRoomTiles = rooms[ghostSpawnRoomIndex]
}
function setStates () {
    changeHuntOrColorState = false
    ghostHunt = false
    win = false
    incenseState = false
    openedMenu = false
    isDifficultySetted = false
    isHouseFloorTile = false
    gameOver = false
    win = false
    difficulty = 1
}
function setIncense () {
    spriteutils.setLifeImage(assets.tile`incenseNoBackground`)
    incense = sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, SpriteKind.Food)
    tiles.placeOnRandomTile(incense, assets.tile`incenseBurning`)
    animation.runImageAnimation(
    incense,
    assets.animation`incienso quemado`,
    incenseDuration / 6,
    true
    )
    incense.z = -1
}
function changeToNormalPalette () {
    color.setColor(1, color.rgb(255, 255, 255))
    color.setColor(2, color.rgb(255, 0, 0))
    color.setColor(3, color.rgb(160, 160, 150))
    color.setColor(4, color.rgb(255, 140, 60))
    color.setColor(5, color.rgb(255, 255, 0))
    color.setColor(6, color.rgb(18, 70, 45))
    color.setColor(7, color.rgb(24, 82, 54))
    color.setColor(8, color.rgb(14, 26, 43))
    color.setColor(9, color.rgb(150, 175, 190))
    color.setColor(10, color.rgb(120, 30, 180))
    color.setColor(11, color.rgb(106, 27, 154))
    color.setColor(12, color.rgb(59, 20, 95))
    color.setColor(13, color.rgb(210, 176, 154))
    color.setColor(14, color.rgb(75, 46, 30))
    color.setColor(15, color.rgb(0, 0, 0))
}
info.onLifeZero(function () {
    info.changeLifeBy(-1)
})
function setSpriteUtils () {
    setPlayerSpawnAndCam()
    setOtherSpriteUtils()
    setIncense()
    setGhost()
    setStates()
    setGhostStats()
    setGhostType()
    setPlayerStats()
    setDifficultySprite()
}
function gameOver2 () {
    changeToNormalPalette()
    infoDisplayed = true
    gameOver = true
    immortalPlayer = true
    incenseState = true
    changeHuntOrColorState = true
    canHunt = false
    controller.moveSprite(mainCharacter, 0, 0)
    ghostReveal = miniMenu.createMenuFromArray([miniMenu.createMenuItem(currentGhostType, skullList[ghostList.indexOf(currentGhostType)]), miniMenu.createMenuItem("Room", ghostSpawnRoom)])
    ghostReveal.setTitle("The Ghost was:")
    noSelectMenu()
    ghostReveal.onButtonPressed(controller.A, function (selection, selectedIndex) {
        ghostReveal.close()
        game.gameOver(win)
    })
    ghostReveal.onButtonPressed(controller.B, function (selection, selectedIndex) {
        ghostReveal.close()
        game.gameOver(win)
    })
}
function setGhostAnimation () {
    animation.runImageAnimation(
    ghost,
    assets.animation`ghostAnimation`,
    flashingGhost,
    true
    )
}
function setPlayerStats () {
    playerVelocity = 100 / difficulty
    controller.moveSprite(mainCharacter, playerVelocity, playerVelocity)
    incenseCount = 1
    info.setLife(incenseCount)
    incenseDuration = 3000 / difficulty
    immunitySpawnTime = 1000 / difficulty
    timeBeforeAtkAfterLightsOff = 2000 / difficulty
    roamToHideTileChance = 10 / difficulty
}
function setOtherSpriteUtils () {
    ghostDirection = sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, SpriteKind.Food)
    difficultyNPC = sprites.create(img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `, SpriteKind.Food)
}
function setGhostType () {
    ghostList = [
    "Demon",
    "Deogen",
    "Mimic",
    "Oni",
    "Revenant",
    "Yokai"
    ]
    skullList = [
    assets.image`DemonSkull`,
    assets.image`DeogenSkull`,
    assets.image`MimicSkull`,
    assets.image`OniSkull`,
    assets.image`RevenantSkull`,
    assets.image`YokaiSkull`
    ]
    currentGhostAbility = ghostList._pickRandom()
    currentGhostType = currentGhostAbility
    ghostAbilitiesList()
}
function setDifficultySprite () {
    animation.runImageAnimation(
    difficultyNPC,
    assets.animation`difficultySelect`,
    500,
    true
    )
    tiles.placeOnRandomTile(difficultyNPC, selectDiffTile)
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function (sprite, otherSprite) {
    if (!(immortalPlayer) && !(incenseState)) {
        gameOver2()
    }
})
let lostTrail = false
let hiding = false
let ghostCanStartMoving = false
let randomTile = 0
let random = 0
let generatedPath = false
let difficultyNPC: Sprite = null
let ghostDirection: Sprite = null
let roamToHideTileChance = 0
let timeBeforeAtkAfterLightsOff = 0
let immunitySpawnTime = 0
let immortalPlayer = false
let incenseDuration = 0
let incense: Sprite = null
let gameOver = false
let isHouseFloorTile = false
let ghostHunt = false
let changeHuntOrColorState = false
let ghostSpawnRoom: Image = null
let ghostSpawnRoomIndex = 0
let ghost: Sprite = null
let roomRuinsRoom: Image[] = []
let roomStorageRoom: Image[] = []
let roomEntranceRoom: Image[] = []
let roomLockerRoom: Image[] = []
let roomBathRoom: Image[] = []
let roomBedRoom: Image[] = []
let roomDinningRoom: Image[] = []
let roomTVRoom: Image[] = []
let roomHallway: Image[] = []
let roomKitchen: Image[] = []
let rooms: Image[][] = []
let selectedDiff: Sprite = null
let incenseCount = 0
let setDifficultyMenu: miniMenu.MenuSprite = null
let incenseState = false
let isDifficultySetted = false
let playerVelocity = 0
let currentGhostType = ""
let canHunt = false
let skullList: Image[] = []
let ghostList: string[] = []
let inputGhostType: miniMenu.MenuSprite = null
let infoDisplayed = false
let openOtherMenu = false
let openedMenu = false
let ghostReadyToHunt = false
let minHuntTime = 0
let difficulty = 0
let ghostReveal: miniMenu.MenuSprite = null
let wallList: Image[] = []
let closedDoor: Image = null
let openDoor: Image = null
let hideTiles: Image[] = []
let otherHouseTilescantSpawn: Image[] = []
let selectDiffTile: Image = null
let houseDefualtTiles: Image[] = []
let maxMimicCooldown = 0
let minMimicCooldown = 0
let ghostSight = false
let sightRange = 0
let ghostCloseSpeed = 0
let wallHacks = false
let maxHuntTime = 0
let looseTrailTime = 0
let ghostSightSpeed = 0
let ghostSpeed = 0
let minAtkCooldown = 0
let maxAtkCooldown = 0
let flashingGhost = 0
let currentGhostAbility = ""
let win = false
let ghostSpawnRoomTiles: Image[] = []
let mainCharacter: Sprite = null
changeToNormalPalette()
setMap()
setSpriteUtils()
scene.cameraFollowSprite(mainCharacter)
forever(function () {
    if (ghostReadyToHunt) {
        if (!(ghostSight)) {
            if (!(generatedPath)) {
                random = randint(0, roamToHideTileChance)
                if (random == 0) {
                    randomTile = randint(0, hideTiles.length - 1)
                } else {
                    randomTile = randint(0, houseDefualtTiles.length - 1)
                }
                tiles.placeOnRandomTile(ghostDirection, houseDefualtTiles[randomTile])
                generatedPath = true
            } else {
                if (ghostCanStartMoving) {
                    scene.followPath(ghost, scene.aStar(tiles.locationOfSprite(ghost), tiles.locationOfSprite(ghostDirection)), ghostSpeed)
                    pause(350)
                    if (spriteutils.distanceBetween(ghost, ghostDirection) < 3) {
                        generatedPath = false
                    }
                } else {
                    if (scene.spriteIsFollowingPath(ghost)) {
                        if (spriteutils.distanceBetween(ghost, ghostDirection) < 9999999999) {
                            generatedPath = false
                        }
                    }
                }
            }
        }
    }
})
forever(function () {
    if (currentGhostType == "Mimic") {
        while (true) {
            currentGhostAbility = ghostList._pickRandom()
            if (currentGhostAbility != currentGhostType) {
                setGhostStats()
                ghostAbilitiesList()
                break;
            }
        }
        pause(randint(minMimicCooldown, maxMimicCooldown))
    } else {
        pause(9999999999)
    }
})
forever(function () {
    if (ghostHunt && !(incenseState)) {
        if (!(hiding) || wallHacks) {
            for (let index = 0; index < looseTrailTime / 100; index++) {
                pause(100)
                if (sight.isInSight(
                ghost,
                mainCharacter,
                sightRange,
                wallHacks
                )) {
                    lostTrail = false
                    break;
                }
            }
            if (lostTrail) {
                ghostSight = false
            } else {
                lostTrail = true
            }
        }
    } else {
        pause(incenseDuration)
    }
})
forever(function () {
    if (ghostHunt) {
        if (ghostSight && !(hiding)) {
            pause(300)
            if (spriteutils.distanceBetween(mainCharacter, ghost) < 48) {
                scene.followPath(ghost, scene.aStar(tiles.locationOfSprite(ghost), tiles.locationOfSprite(mainCharacter)), ghostCloseSpeed)
            } else {
                scene.followPath(ghost, scene.aStar(tiles.locationOfSprite(ghost), tiles.locationOfSprite(mainCharacter)), ghostSightSpeed)
            }
        }
    }
})
forever(function () {
    if (ghostHunt && !(incenseState)) {
        if (!(hiding) || wallHacks) {
            if (sight.isInSight(
            ghost,
            mainCharacter,
            sightRange,
            wallHacks
            )) {
                generatedPath = false
                ghostSight = true
            }
        }
    } else {
        pause(incenseDuration)
    }
})
forever(function () {
    if (hiding) {
        ghostSight = false
    }
})
forever(function () {
    if (canHunt) {
        isDifficultySetted = true
        if (!(changeHuntOrColorState)) {
            tileUtil.replaceAllTiles(closedDoor, openDoor)
            tileUtil.setWalls(openDoor, false)
            ghostCanStartMoving = false
            tiles.placeOnRandomTile(ghost, ghostSpawnRoom)
            changeToNormalPalette()
            generatedPath = false
            lostTrail = false
            ghostReadyToHunt = false
            ghostHunt = false
            if (!(wallHacks)) {
                ghostSight = false
            }
            ghost.setScale(0, ScaleAnchor.Middle)
            pause(randint(minAtkCooldown, maxAtkCooldown))
        }
        if (!(changeHuntOrColorState)) {
            tileUtil.replaceAllTiles(openDoor, closedDoor)
            tileUtil.setWalls(closedDoor, true)
            ghostReadyToHunt = true
            changToHuntPalette()
            if (openedMenu) {
                openedMenu = false
                inputGhostType.close()
                controller.moveSprite(mainCharacter, playerVelocity, playerVelocity)
            }
            pause(timeBeforeAtkAfterLightsOff)
            tiles.placeOnRandomTile(ghost, ghostSpawnRoom)
            ghostCanStartMoving = true
            ghostHunt = true
            ghost.changeScale(1, ScaleAnchor.Middle)
            immortalPlayer = true
            pause(immunitySpawnTime)
            immortalPlayer = false
            pause(randint(minHuntTime, maxHuntTime))
        }
    }
})
forever(function () {
    if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`vanFloor`)) {
        if (infoDisplayed) {
            infoDisplayed = false
            ghostReveal.close()
        }
        infoDisplayed = false
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`Demon`)) {
        if (!(infoDisplayed)) {
            infoDisplayed = true
            ghostReveal = miniMenu.createMenuFromArray([miniMenu.createMenuItem(ghostList[0], skullList[0]), miniMenu.createMenuItem("Attacks more frequently")])
            noSelectMenu()
        }
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`Deogen`)) {
        if (!(infoDisplayed)) {
            infoDisplayed = true
            ghostReveal = miniMenu.createMenuFromArray([miniMenu.createMenuItem(ghostList[1], skullList[1]), miniMenu.createMenuItem("You can't hide, run!")])
            noSelectMenu()
        }
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`Mimic`)) {
        if (!(infoDisplayed)) {
            infoDisplayed = true
            ghostReveal = miniMenu.createMenuFromArray([miniMenu.createMenuItem(ghostList[2], skullList[2]), miniMenu.createMenuItem("Mimics others abilities")])
            noSelectMenu()
        }
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`Oni`)) {
        if (!(infoDisplayed)) {
            infoDisplayed = true
            ghostReveal = miniMenu.createMenuFromArray([miniMenu.createMenuItem(ghostList[3], skullList[3]), miniMenu.createMenuItem("Blinks more frequently")])
            noSelectMenu()
        }
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`Revenant`)) {
        if (!(infoDisplayed)) {
            infoDisplayed = true
            ghostReveal = miniMenu.createMenuFromArray([miniMenu.createMenuItem(ghostList[4], skullList[4]), miniMenu.createMenuItem("Slow at base..."), miniMenu.createMenuItem("Fast when chasing!")])
            noSelectMenu()
            ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Rows, 3)
            ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Height, 70)
            ghostReveal.setPosition(scene.cameraProperty(CameraProperty.X), scene.cameraProperty(CameraProperty.Y))
        }
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`YokaiVan`)) {
        if (!(infoDisplayed)) {
            infoDisplayed = true
            ghostReveal = miniMenu.createMenuFromArray([miniMenu.createMenuItem(ghostList[5], skullList[5]), miniMenu.createMenuItem("Can only see closely")])
            noSelectMenu()
        }
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`info`)) {
        controller.moveSprite(mainCharacter, 0, 0)
        game.showLongText("FIND AND PURIFY THE GHOST ROOM AND GUESS THE GHOST TYPE!", DialogLayout.Bottom)
        game.showLongText("Read the ghost behavior on the corresponding skulls.", DialogLayout.Bottom)
        game.showLongText("Observe the ghost's behavior.", DialogLayout.Bottom)
        game.showLongText("Press A to open the book.", DialogLayout.Bottom)
        game.showLongText("Press A to select a ghost.", DialogLayout.Bottom)
        game.showLongText("Press B to exit the book.", DialogLayout.Bottom)
        game.showLongText("WATCH OUT, ALL GHOST BLINK!", DialogLayout.Bottom)
        controller.moveSprite(mainCharacter, playerVelocity, playerVelocity)
        pause(2000)
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`incenseDefault`) || tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), assets.tile`incenseBurning`)) {
        if (!(infoDisplayed)) {
            infoDisplayed = true
            ghostReveal = miniMenu.createMenuFromArray([
            miniMenu.createMenuItem("Incense", assets.tile`incenseNoBackground`),
            miniMenu.createMenuItem("Press \"B\" to use"),
            miniMenu.createMenuItem("Grants: immunity"),
            miniMenu.createMenuItem("Grants: invisibility"),
            miniMenu.createMenuItem("Duration: " + incenseDuration / 1000 + " seconds")
            ])
            noSelectMenu()
            ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Rows, 5)
            ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Height, 90)
            ghostReveal.setMenuStyleProperty(miniMenu.MenuStyleProperty.Width, 150)
            ghostReveal.setPosition(scene.cameraProperty(CameraProperty.X), scene.cameraProperty(CameraProperty.Y))
        }
    } else if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), selectDiffTile)) {
        if (!(infoDisplayed)) {
            setDifficulty()
        }
    }
})
forever(function () {
    characterAnimations.loopFrames(
    mainCharacter,
    assets.animation`runR`,
    100,
    characterAnimations.rule(Predicate.FacingRight, Predicate.Moving)
    )
    characterAnimations.loopFrames(
    mainCharacter,
    assets.animation`runL`,
    100,
    characterAnimations.rule(Predicate.FacingLeft, Predicate.Moving)
    )
    characterAnimations.loopFrames(
    mainCharacter,
    assets.animation`playerStandingStill`,
    300,
    characterAnimations.rule(Predicate.FacingRight, Predicate.NotMoving)
    )
    characterAnimations.loopFrames(
    mainCharacter,
    assets.animation`playerStandingStillL`,
    300,
    characterAnimations.rule(Predicate.FacingLeft, Predicate.NotMoving)
    )
})
forever(function () {
    if (!(gameOver)) {
        for (let tile of houseDefualtTiles) {
            if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), tile)) {
                isHouseFloorTile = true
                hiding = false
                break;
            }
        }
        if (!(isHouseFloorTile)) {
            for (let tile of otherHouseTilescantSpawn) {
                if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), tile)) {
                    isHouseFloorTile = true
                    hiding = false
                    break;
                }
            }
            if (!(isHouseFloorTile)) {
                for (let tile2 of hideTiles) {
                    if (tiles.tileAtLocationEquals(tiles.getTileLocation(mainCharacter.x / 16, mainCharacter.y / 16), tile2)) {
                        hiding = true
                        ghostSight = false
                        isHouseFloorTile = true
                        break;
                    }
                }
            }
        }
        if (isHouseFloorTile) {
            canHunt = true
            changeHuntOrColorState = false
            isHouseFloorTile = false
        } else {
            canHunt = false
            changeHuntOrColorState = true
        }
    }
})
forever(function () {
    if (!(incenseState) && controller.B.isPressed()) {
        if (!(openedMenu) && !(openOtherMenu) && !(infoDisplayed)) {
            if (incenseCount > 0) {
                incenseCount = incenseCount - 1
                info.setLife(incenseCount)
                immortalPlayer = true
                ghostSight = false
                incenseState = true
                incense = sprites.create(img`
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    . . . . . . . . . . . . . . . . 
                    `, SpriteKind.Food)
                incense.setPosition(mainCharacter.x, mainCharacter.y)
                animation.runImageAnimation(
                incense,
                assets.animation`incienso quemado`,
                incenseDuration / 6,
                false
                )
                incense.z = -1
                pause(incenseDuration)
                immortalPlayer = false
                incenseState = false
            }
        }
    }
})
forever(function () {
    if (ghostReadyToHunt) {
        if (ghostSight) {
            music.play(music.createSong(assets.song`huntbBeat0`), music.PlaybackMode.UntilDone)
        } else {
            music.play(music.createSong(assets.song`readyToHuntbBeat0`), music.PlaybackMode.UntilDone)
        }
    } else {
        if (canHunt) {
            music.play(music.createSong(assets.song`beat0`), music.PlaybackMode.UntilDone)
        } else {
            music.play(music.createSong(assets.song`chill0`), music.PlaybackMode.UntilDone)
        }
    }
    if (ghostReadyToHunt) {
        if (ghostSight) {
            music.play(music.createSong(assets.song`huntbBeat3`), music.PlaybackMode.UntilDone)
        } else {
            music.play(music.createSong(assets.song`readyToHuntbBeat3`), music.PlaybackMode.UntilDone)
        }
    } else {
        if (canHunt) {
            music.play(music.createSong(assets.song`beat3`), music.PlaybackMode.UntilDone)
        } else {
            music.play(music.createSong(assets.song`chill1`), music.PlaybackMode.UntilDone)
        }
    }
})
forever(function () {
    if (isDifficultySetted) {
        sprites.destroy(difficultyNPC)
    }
})
